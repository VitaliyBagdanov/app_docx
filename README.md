# üìÑ FastAPI Docx Template Service

**–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ docx-—Ñ–∞–π–ª–æ–≤ –ø–æ —à–∞–±–ª–æ–Ω—É –∏ –¥–∞–Ω–Ω—ã–º –∏–∑ PostgreSQL.  
–†–∞–±–æ—Ç–∞–µ—Ç –≤ Docker, —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ CI/CD, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.**

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç docx-–¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞ (`template.docx`) –∏–∑ volume.
- –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (`secretary`, `body`) –∏–∑ PostgreSQL –ø–æ ID.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ volume (`shared_data`).
- REST API —Å –≤–∞–ª–∏–¥–∏—Ä—É–µ–º—ã–º POST-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º.
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ docker-compose —Å—Ç–µ–∫ (Postgres, n8n, nginx –∏ —Ç.–¥.).

---

## üì¶ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/XXXX
cd fastapi-docx-service
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ `.env`

–°–æ–∑–¥–∞–π—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ:


### 3. –§–∞–π–ª —à–∞–±–ª–æ–Ω–∞

–ü–æ–ª–æ–∂–∏—Ç–µ –≤–∞—à `template.docx` –≤ –ø–∞–ø–∫—É `shared_data/` (–∏–ª–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–∞ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞).

### 4. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
docker-compose up --build -d
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

#### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç

```bash
curl -X POST http://localhost:8000/generate-docx \
  -H "Content-Type: application/json" \
  -d '{"id": "math-001"}'
```

–û—Ç–≤–µ—Ç:

```json
{
  "status": "success",
  "filename": "math-001_output.docx",
  "detail": "File generated and saved in shared_data."
}
```

---

## üîó –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### POST `/generate-docx`

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "id": "math-001"
}
```
**–û—Ç–≤–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—Ö–µ:**
```json
{
  "status": "success",
  "filename": "math-001_output.docx",
  "detail": "File generated and saved in shared_data."
}
```
**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:**

- `404`: –î–æ–∫—É–º–µ–Ω—Ç —Å —Ç–∞–∫–∏–º id –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500`: –ù–µ—Ç —à–∞–±–ª–æ–Ω–∞ –∏–ª–∏ –æ—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞

---

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

```sql
CREATE TABLE documents (
    id VARCHAR PRIMARY KEY,
    secretary VARCHAR,
    body TEXT
);
-- –ü—Ä–∏–º–µ—Ä:
INSERT INTO documents (id, secretary, body) VALUES
('math-001', '–ò–≤–∞–Ω–æ–≤ –ò.–ò.', '–£–≤–∞–∂–∞–µ–º—ã–µ –∫–æ–ª–ª–µ–≥–∏! ...');
```

---

## üéõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker Compose

- **fastapi-docx-service:** FastAPI —Å–µ—Ä–≤–∏—Å (current repo)
- **db:** PostgreSQL —Å–µ—Ä–≤–∏—Å
- **shared_data:** —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ volume –¥–ª—è docx —Ñ–∞–π–ª–æ–≤/—à–∞–±–ª–æ–Ω–æ–≤
- **n8n, nginx:** –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (—Å–º. docker-compose.yml)

---

## ‚öôÔ∏è –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —à–∞–±–ª–æ–Ω/–º–µ—Ç–∫—É?

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä (`{field}`) –≤ —à–∞–±–ª–æ–Ω.
2. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç–æ–ª–±–µ—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –µ–≥–æ –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≤ –∫–æ–¥–µ.
3. –û–±–Ω–æ–≤–∏—Ç–µ docx_handler.py ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∑–∞–º–µ–Ω—É –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π.

---

## üìù –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.
- –ü—Ä–æ–µ–∫—Ç –ª–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –ø–æ–¥ k8s –∏–ª–∏ clustered-—Ä–µ—à–µ–Ω–∏—è.
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è—Ä–Ω–∞ (–ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å API, –¥–æ–±–∞–≤–ª—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É).

---

## üìö –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

- –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose logs fastapi-app` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º `python3 -m venv venv; source venv/bin/activate; pip install -r requirements.txt`
- –î–ª—è –¥–µ–ø–ª–æ—è –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞–∫:
    ```bash
    git pull
    docker-compose build fastapi-app
    docker-compose up -d
    ```

---

## üóÇÔ∏è C—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
  ‚îú‚îÄ‚îÄ main.py
  ‚îú‚îÄ‚îÄ db.py
  ‚îú‚îÄ‚îÄ schemas.py
  ‚îú‚îÄ‚îÄ docx_handler.py
  ‚îú‚îÄ‚îÄ config.py
shared_data/
  ‚îú‚îÄ‚îÄ template.docx
requirements.txt
docker-compose.yml
README.md
```

---

## ‚ùì FAQ / troubleshoot

- **–ù–µ—Ç —Ñ–∞–π–ª–∞:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `template.docx` –ª–µ–∂–∏—Ç –≤ `shared_data/`
- **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ POSTGRES_HOST —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏–º–µ–Ω–µ–º —Å–ª—É–∂–±—ã –≤ docker-compose
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∏ —Å–∞–º –∑–∞–ø—Ä–æ—Å

---

## üèóÔ∏è –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è —Ñ–∏—á-—Ä–µ–∫–≤–µ—Å—Ç–æ–≤/–±–∞–≥–æ–≤ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ issues –Ω–∞ [GitHub](https://github.com/yourorg/fastapi-docx-service/issues).

